from diffusion.lattice_dataset import CrystalDataset


def main():
    dataset = CrystalDataset(
        [
            # "datasets/alexandria_hdf5/alexandria_ps_000_take10.h5",
            "datasets/alexandria_hdf5/alexandria_ps_000.h5",
            "datasets/alexandria_hdf5/alexandria_ps_001.h5",
            "datasets/alexandria_hdf5/alexandria_ps_002.h5",
            "datasets/alexandria_hdf5/alexandria_ps_003.h5",
            "datasets/alexandria_hdf5/alexandria_ps_004.h5",
        ]
    )

    most_atoms = 0
    most_atoms_config = None
    most_atoms_config_idx = 0
    for i in range(len(dataset.configs)):
        num_atoms = len(dataset.configs[i].atomic_numbers)
        if num_atoms > most_atoms:
            most_atoms = num_atoms
            most_atoms_config = dataset.configs[i]
            most_atoms_config_idx = i

    print(f"Most atoms: {most_atoms}")
    print(
        f"Most atoms config: {most_atoms_config.X0}, {most_atoms_config.L0}, {most_atoms_config.atomic_numbers}"
    )
    print(f"Most atoms config idx: {most_atoms_config_idx}")


"""
Most atoms: 236
Most atoms config: [[2.1392434e-01 4.1133750e-02 5.8910945e-01]
 [6.6594863e-01 9.5886625e-01 4.1089055e-01]
 [5.0505808e-01 4.5886625e-01 8.9109450e-02]
 [8.7481488e-01 5.4113375e-01 9.1089055e-01]
 [1.8480594e-01 7.6602870e-02 6.8396343e-01]
 [5.7744438e-01 9.2339713e-01 3.1603657e-01]
 [5.1140781e-01 4.2339713e-01 1.8396343e-01]
 [7.5084251e-01 5.7660287e-01 8.1603657e-01]
 [9.8404168e-01 8.3328044e-01 5.7792933e-01]
 [2.3939180e-01 1.6671956e-01 4.2207067e-01]
 [6.7321120e-02 6.6671956e-01 7.7929330e-02]
 [6.5611136e-01 3.3328044e-01 9.2207067e-01]
 [9.5685646e-01 8.6973865e-01 6.7310755e-01]
 [1.5348756e-01 1.3026135e-01 3.2689245e-01]
 [7.6595110e-02 6.3026135e-01 1.7310755e-01]
 [5.3374991e-01 3.6973865e-01 8.2689245e-01]
 [7.7911247e-01 2.5555688e-01 5.6680153e-01]
 [4.6786783e-01 7.4444312e-01 4.3319847e-01]
 [2.8466936e-01 2.4444312e-01 6.6801530e-02]
 [4.6231095e-01 7.5555688e-01 9.3319847e-01]
 [7.4898895e-01 2.9349692e-01 6.6183672e-01]
 [3.8065014e-01 7.0650308e-01 3.3816328e-01]
 [2.9248587e-01 2.0650308e-01 1.6183672e-01]
 [3.3715222e-01 7.9349692e-01 8.3816328e-01]
 [3.2431000e-03 2.9162060e-02 5.4437663e-01]
 [4.8802853e-01 9.7083794e-01 4.5562337e-01]
 [2.8240516e-01 4.7083794e-01 4.4376630e-02]
 [7.0886747e-01 5.2916206e-01 9.5562337e-01]
 [9.5269502e-01 9.4240580e-02 7.0657073e-01]
 [3.4036587e-01 9.0575942e-01 2.9342927e-01]
 [2.9693660e-01 4.0575942e-01 2.0657073e-01]
 [4.9612529e-01 5.9424058e-01 7.9342927e-01]
 [4.2684597e-01 7.9261062e-01 5.6324260e-01]
 [6.5621499e-01 2.0738938e-01 4.3675740e-01]
 [4.6945659e-01 7.0738938e-01 6.3242600e-02]
 [1.1360437e-01 2.9261062e-01 9.3675740e-01]
 [4.9833836e-01 8.4107543e-01 6.1234546e-01]
 [7.2706734e-01 1.5892457e-01 3.8765454e-01]
 [5.8941280e-01 6.5892457e-01 1.1234546e-01]
 [1.3599190e-01 3.4107543e-01 8.8765454e-01]
 [3.6842813e-01 7.5485093e-01 6.0871051e-01]
 [5.1456855e-01 2.4514907e-01 3.9128949e-01]
 [3.7327906e-01 7.4514907e-01 1.0871051e-01]
 [9.7176200e-03 2.5485093e-01 8.9128949e-01]
 [1.6374360e-01 2.8909082e-01 5.5667565e-01]
 [8.9615877e-01 7.1090918e-01 4.4332435e-01]
 [7.0283442e-01 2.1090918e-01 5.6675650e-02]
 [8.5706795e-01 7.8909082e-01 9.4332435e-01]
 [3.6069933e-01 1.9054649e-01 5.8537961e-01]
 [9.6586620e-01 8.0945351e-01 4.1462039e-01]
 [8.0124581e-01 3.0945351e-01 8.5379610e-02]
 [2.5319710e-02 6.9054649e-01 9.1462039e-01]
 [3.2261942e-01 1.1729730e-01 5.3612289e-01]
 [9.0379384e-01 8.8270270e-01 4.6387711e-01]
 [6.8991673e-01 3.8270270e-01 3.6122890e-02]
 [3.6495530e-02 6.1729730e-01 9.6387711e-01]
 [3.4262882e-01 7.8312175e-01 6.7838588e-01]
 [4.4736470e-01 2.1687825e-01 3.2161412e-01]
 [3.7575058e-01 7.1687825e-01 1.7838588e-01]
 [9.1424295e-01 2.8312175e-01 8.2161412e-01]
 [4.7350827e-01 8.6759920e-01 6.8944059e-01]
 [6.5166688e-01 1.3240080e-01 3.1055941e-01]
 [5.9110747e-01 6.3240080e-01 1.8944059e-01]
 [3.4067670e-02 3.6759920e-01 8.1055941e-01]
 [3.7546299e-01 8.4665152e-01 7.2900218e-01]
 [4.9311233e-01 1.5334848e-01 2.7099782e-01]
 [4.7211451e-01 6.5334848e-01 2.2900218e-01]
 [8.9646081e-01 3.4665152e-01 7.7099782e-01]
 [2.4744931e-01 2.0320131e-01 7.4659307e-01]
 [7.0405755e-01 7.9679869e-01 2.5340693e-01]
 [7.0065062e-01 2.9679869e-01 2.4659307e-01]
 [7.5085624e-01 7.0320131e-01 7.5340693e-01]
 [3.2930109e-01 2.3040064e-01 7.0416937e-01]
 [8.5553236e-01 7.6959936e-01 2.9583063e-01]
 [8.0970173e-01 2.6959936e-01 2.0416937e-01]
 [8.7513172e-01 7.3040064e-01 7.9583063e-01]
 [1.1830989e-01 3.4858977e-01 7.0877464e-01]
 [7.5812503e-01 6.5141023e-01 2.9122536e-01]
 [7.1689966e-01 1.5141023e-01 2.0877464e-01]
 [6.5953626e-01 8.4858977e-01 7.9122536e-01]
 [2.6191802e-01 6.2199820e-01 5.6640474e-01]
 [3.1751048e-01 3.7800180e-01 4.3359526e-01]
 [1.3391522e-01 8.7800180e-01 6.6404740e-02]
 [9.4551329e-01 1.2199820e-01 9.3359526e-01]
 [1.3408531e-01 5.4082253e-01 5.7274907e-01]
 [1.0215877e-01 4.5917747e-01 4.2725093e-01]
 [9.2490785e-01 9.5917747e-01 7.2749070e-02]
 [8.1133524e-01 4.0822530e-02 9.2725093e-01]
 [1.1423210e-01 6.3153348e-01 5.2523658e-01]
 [2.2052901e-01 3.6846652e-01 4.7476342e-01]
 [9.9576558e-01 8.6846652e-01 2.5236580e-02]
 [8.3899452e-01 1.3153348e-01 9.7476342e-01]
 [7.4419056e-01 8.6282446e-01 5.2987097e-01]
 [7.7144040e-02 1.3717554e-01 4.7012903e-01]
 [8.5701501e-01 6.3717554e-01 2.9870970e-02]
 [4.6431959e-01 3.6282446e-01 9.7012903e-01]
 [7.6824073e-01 7.5963651e-01 5.7529686e-01]
 [9.5258139e-01 2.4036349e-01 4.2470314e-01]
 [7.7787725e-01 7.4036349e-01 7.5296860e-02]
 [4.4294388e-01 2.5963651e-01 9.2470314e-01]
 [6.8306847e-01 9.6984122e-01 5.7591582e-01]
 [7.6993870e-02 3.0158780e-02 4.2408418e-01]
 [9.0290969e-01 5.3015878e-01 7.5915820e-02]
 [3.5715264e-01 4.6984122e-01 9.2408418e-01]
 [3.8762260e-02 7.0806809e-01 7.3542226e-01]
 [1.1408090e-02 2.9193191e-01 2.6457774e-01]
 [9.9683035e-01 7.9193191e-01 2.3542226e-01]
 [5.5334000e-01 2.0806809e-01 7.6457774e-01]
 [1.0639576e-01 5.8627626e-01 6.9143093e-01]
 [1.2410900e-03 4.1372374e-01 3.0856907e-01]
 [9.4267202e-01 9.1372374e-01 1.9143093e-01]
 [6.6496483e-01 8.6276260e-02 8.0856907e-01]
 [2.1502786e-01 6.8203612e-01 7.1597826e-01]
 [1.8108571e-01 3.1796388e-01 2.8402174e-01]
 [1.4706398e-01 8.1796388e-01 2.1597826e-01]
 [7.4904959e-01 1.8203612e-01 7.8402174e-01]
 [6.6133334e-01 9.9471331e-01 6.4603842e-01]
 [1.0009220e-02 5.2866900e-03 3.5396158e-01]
 [9.0604665e-01 5.0528669e-01 1.4603842e-01]
 [2.6529591e-01 4.9471331e-01 8.5396158e-01]
 [7.4564159e-01 7.8833154e-01 6.5628221e-01]
 [8.7769092e-01 2.1166846e-01 3.4371779e-01]
 [7.8397314e-01 7.1166846e-01 1.5628221e-01]
 [3.3935938e-01 2.8833154e-01 8.4371779e-01]
 [7.0133326e-01 9.2672625e-01 6.9766796e-01]
 [9.3039055e-01 7.3273750e-02 3.0233204e-01]
 [8.7805952e-01 5.7327375e-01 1.9766796e-01]
 [2.5366530e-01 4.2672625e-01 8.0233204e-01]
 [5.8118309e-01 1.8207317e-01 5.2632109e-01]
 [2.3693516e-01 8.1792683e-01 4.7367891e-01]
 [1.3256260e-02 3.1792683e-01 2.6321090e-02]
 [3.0486200e-01 6.8207317e-01 9.7367891e-01]
 [4.8505473e-01 3.8536240e-01 5.4118190e-01]
 [3.2923523e-01 6.1463760e-01 4.5881810e-01]
 [1.2041713e-01 1.1463760e-01 4.1181900e-02]
 [1.9387283e-01 8.8536240e-01 9.5881810e-01]
 [6.0598309e-01 3.2131807e-01 5.0005502e-01]
 [4.2724613e-01 6.7868193e-01 4.9994498e-01]
 [1.7730116e-01 1.7868193e-01 5.5020000e-05]
 [3.5592806e-01 8.2131807e-01 9.9994498e-01]
 [8.3787332e-01 4.3901797e-01 5.3340627e-01]
 [7.4348402e-01 5.6098203e-01 4.6659373e-01]
 [5.2689029e-01 6.0982030e-02 3.3406270e-02]
 [5.5446605e-01 9.3901797e-01 9.6659373e-01]
 [7.0438955e-01 5.3956612e-01 5.7123733e-01]
 [6.7271834e-01 4.6043388e-01 4.2876267e-01]
 [4.9395567e-01 9.6043388e-01 7.1237330e-02]
 [3.8315122e-01 3.9566120e-02 9.2876267e-01]
 [9.1702852e-01 4.1726657e-01 5.8648564e-01]
 [7.4780845e-01 5.8273343e-01 4.1351436e-01]
 [5.8429509e-01 8.2733430e-02 8.6485640e-02]
 [5.8054288e-01 9.1726657e-01 9.1351436e-01]
 [5.3845190e-01 3.9710873e-01 7.0907539e-01]
 [2.2648524e-01 6.0289127e-01 2.9092461e-01]
 [1.8556063e-01 1.0289127e-01 2.0907539e-01]
 [7.9376510e-02 8.9710873e-01 7.9092461e-01]
 [4.4927667e-01 4.3572489e-01 6.5672054e-01]
 [2.2828103e-01 5.6427511e-01 3.4327946e-01]
 [1.3500157e-01 6.4275110e-02 1.5672054e-01]
 [4.2555130e-02 9.3572489e-01 8.4327946e-01]
 [5.3039991e-01 2.4275236e-01 6.7757819e-01]
 [9.5573090e-02 7.5724764e-01 3.2242181e-01]
 [2.3151270e-02 2.5724764e-01 1.7757819e-01]
 [1.0282172e-01 7.4275236e-01 8.2242181e-01]
 [8.9411355e-01 4.4731469e-01 6.5778760e-01]
 [6.8364064e-01 5.5268531e-01 3.4221240e-01]
 [5.9142824e-01 5.2685310e-02 1.5778760e-01]
 [4.8632595e-01 9.4731469e-01 8.4221240e-01]
 [6.7817513e-01 5.7042222e-01 6.4944758e-01]
 [5.9914977e-01 4.2957778e-01 3.5055242e-01]
 [4.9859735e-01 9.2957778e-01 1.4944758e-01]
 [2.7872655e-01 7.0422220e-02 8.5055242e-01]
 [7.7835229e-01 5.0820185e-01 7.0012706e-01]
 [5.8642709e-01 4.9179815e-01 2.9987294e-01]
 [5.3655415e-01 9.9179815e-01 2.0012706e-01]
 [3.2822524e-01 8.2018500e-03 7.9987294e-01]
 [3.9349483e-01 8.3759432e-01 5.9405534e-01]
 [6.3703380e-01 1.6240568e-01 4.0594466e-01]
 [4.8108914e-01 6.6240568e-01 9.4055340e-02]
 [4.9439490e-02 3.3759432e-01 9.0594466e-01]
 [2.6948037e-01 1.7230158e-01 5.6457387e-01]
 [8.7720808e-01 8.2769842e-01 4.3542613e-01]
 [6.9178195e-01 3.2769842e-01 6.4573870e-02]
 [9.5490750e-01 6.7230158e-01 9.3542613e-01]
 [3.5986637e-01 8.7514437e-01 6.9625215e-01]
 [5.3875858e-01 1.2485563e-01 3.0374785e-01]
 [4.8501073e-01 6.2485563e-01 1.9625215e-01]
 [9.1361422e-01 3.7514437e-01 8.0374785e-01]
 [2.2331383e-01 2.2900053e-01 7.1346688e-01]
 [7.3884749e-01 7.7099947e-01 2.8653312e-01]
 [7.0231437e-01 2.7099947e-01 2.1346688e-01]
 [7.5984695e-01 7.2900053e-01 7.8653312e-01]
 [1.3806319e-01 6.3880193e-01 5.5886334e-01]
 [2.1800178e-01 3.6119807e-01 4.4113666e-01]
 [2.6865120e-02 8.6119807e-01 5.8863340e-02]
 [8.2919985e-01 1.3880193e-01 9.4113666e-01]
 [7.7583573e-01 8.5912084e-01 5.6350772e-01]
 [7.1448850e-02 1.4087916e-01 4.3649228e-01]
 [8.8495757e-01 6.4087916e-01 6.3507720e-02]
 [4.6232801e-01 3.5912084e-01 9.3649228e-01]
 [9.2817790e-02 6.9578185e-01 7.0704682e-01]
 [8.1553810e-02 3.0421815e-01 2.9295318e-01]
 [3.8600640e-02 8.0421815e-01 2.0704682e-01]
 [6.3577097e-01 1.9578185e-01 7.9295318e-01]
 [7.4592817e-01 8.9820201e-01 6.6743244e-01]
 [9.7669774e-01 1.0179799e-01 3.3256756e-01]
 [8.9413018e-01 6.0179799e-01 1.6743244e-01]
 [3.2849572e-01 3.9820201e-01 8.3256756e-01]
 [5.9615761e-01 2.8802408e-01 5.3042021e-01]
 [3.5376148e-01 7.1197592e-01 4.6957979e-01]
 [1.3418169e-01 2.1197592e-01 3.0420210e-02]
 [3.1573640e-01 7.8802408e-01 9.6957979e-01]
 [8.1325397e-01 4.2891867e-01 5.6443578e-01]
 [6.7773686e-01 5.7108133e-01 4.3556422e-01]
 [4.9217264e-01 7.1081330e-02 6.4435780e-02]
 [4.9881819e-01 9.2891867e-01 9.3556422e-01]
 [5.4838345e-01 3.4658358e-01 6.7784934e-01]
 [2.1711869e-01 6.5341642e-01 3.2215066e-01]
 [1.4496803e-01 1.5341642e-01 1.7784934e-01]
 [1.2053511e-01 8.4658358e-01 8.2215066e-01]
 [7.7877541e-01 4.7100988e-01 6.6769885e-01]
 [5.8208744e-01 5.2899012e-01 3.3230115e-01]
 [4.9978630e-01 2.8990120e-02 1.6769885e-01]
 [3.6107656e-01 9.7100988e-01 8.3230115e-01]
 [1.6232354e-01 1.1649751e-01 6.3468282e-01]
 [6.4413823e-01 8.8350249e-01 3.6531718e-01]
 [5.2882106e-01 3.8350249e-01 1.3468282e-01]
 [7.7764072e-01 6.1649751e-01 8.6531718e-01]
 [2.7894850e-02 8.3198163e-01 6.2838955e-01]
 [2.3148693e-01 1.6801837e-01 3.7161045e-01]
 [1.0987648e-01 6.6801837e-01 1.2838955e-01]
 [6.4950530e-01 3.3198163e-01 8.7161045e-01]
 [7.4375212e-01 2.3812312e-01 6.1329099e-01]
 [3.6858425e-01 7.6187688e-01 3.8670901e-01]
 [2.3187424e-01 2.6187688e-01 1.1329099e-01]
 [3.8046113e-01 7.3812312e-01 8.8670901e-01]], [[ 9.53287616 -0.         -0.        ]
 [ 4.76643808  8.45980784  0.        ]
 [-4.76643808 -0.         32.61733948]], [14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14
 33 33 33 33 33 33 33 33  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
  1  1  1  1  1  1  1  1  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6
  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6
  6  6  6  6  6  6  6  6  8  8  8  8  8  8  8  8  8  8  8  8]
Most atoms config idx: 307385
"""


if __name__ == "__main__":
    main()
